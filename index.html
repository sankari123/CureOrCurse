<!DOCTYPE html>
<html>
  <head>
    <title>locateME@XPressAvenue</title>

    <script type="text/javascript" charset="utf-8" src="phonegap-1.2.0.js"></script>
    <script type="text/javascript" charset="utf-8" src="cordova.js"></script>
    <script type="text/javascript" charset="utf-8">
    // Wait for PhoneGap to load
    //
    document.addEventListener("deviceready", onDeviceReady, false);
    var watchID = null;
    var place_name;
    function onDeviceReady() {
    	//console.log(FileTransfer);
       
    }
function getloc()
{
//	alert("in");
  var options = { enableHighAccuracy: true };
        watchID = navigator.geolocation.watchPosition(onSuccess1, onError1, options);
     //   alert("in");
}
var geo_loc;
var geo_loc1;
function onSuccess1(position) {
//alert(position.coords.latitude);
//alert(position.coords.longitude);
	
geo_loc = position.coords.latitude;
   geo_loc1 = position.coords.longitude;
 document.getElementById('loc_txt').value=geo_loc;
    document.getElementById('loc_txt1').value=geo_loc1;
    }
    function onError1(error) {
          console.log('code: '    + error.code    +  'message: ' + error.message );
        }
        function placeloc()
        {
           place_name=document.getElementById("place_txt").value;
     //     alert(place_name);
        }
        
function saveloc()
{
	place_name=document.getElementById("place_txt").value;
	var db = window.openDatabase("locateME", "1.0", "locateME DB", 200000);
        db.transaction(populateDB, errorCB, successCB);
//alert(geo_loc);
//alert(geo_loc1);
//alert(place_name);
//alert(document.getElementById("place_txt").value);
}

function populateDB(tx) {
    //    tx.executeSql('DROP TABLE IF EXISTS DEMO');
        tx.executeSql('CREATE TABLE IF NOT EXISTS locateME (data1,data2,data3)');
     //   tx.executeSql('INSERT INTO locateME VALUES ('"&geo_loc&"','"&geo_loc1&";)');
     
  
        var sql='INSERT INTO locateME (data1,data2,data3) VALUES ("' + geo_loc+ '","' + geo_loc1+ '","' + place_name+ '")';
       // alert(sql);
          tx.executeSql(sql);
       // tx.executeSql('INSERT INTO DEMO (id, data) VALUES (2, "Second row")');
    }
    function errorCB(err) {
        console.log("Error processing SQL: "+err.code);
    }

    // Transaction success callback
    //
    function successCB() {
        var db = window.openDatabase("locateME", "1.0", "locateME DB", 200000);
        db.transaction(queryDB, errorCB);
    }
    function queryDB(tx) {
        tx.executeSql('SELECT * FROM locateME', [], querySuccess, errorCB);
    }
    function querySuccess(tx, results) {
    	var myTable = document.getElementById('dbTable');
        var len = results.rows.length;
        console.log("locateME table: " + len + " rows found.");
        for (var i=0; i<len; i++){
        //	alert(results.rows.item(i).data1);
        //	alert(results.rows.item(i).data2);
        
		myTable.rows[i].cells[1].innerHTML = results.rows.item(i).data1;
		myTable.rows[i].cells[2].innerHTML = results.rows.item(i).data2;
		myTable.rows[i].cells[3].innerHTML = results.rows.item(i).data3;
		
           // console.log("Row = " + i + " ID = " + results.rows.item(i).data1 + " Data =  " + results.rows.item(i).data2);
        }
    }
    
    
    </script>
    <style>
      .btncss
	{
	background:none;
	border:none;
	padding:0;
	cursor:pointer;
	font: 8pt arial;
	font-family:Oswald, sans-serif; /*Oswald is available from http://www.google.com/webfonts/specimen/Oswald*/
	color: #b32d5f;
	}

    </style>
  </head>
  <body>
    <h1>locateME</h1>
    <p>Database</p>
    <input type=text id=loc_txt><input type=text id=loc_txt1><button onclick="getloc();" class="btncss">Get Latitude and Longitude</button><br>
    <input type=text id=place_txt><button onclick="placeloc();" class="btncss">Enter Place Name</button><br>
    <button onclick="saveloc();" class="btncss">Save Location</button><br>
    <table id="dbTable" border="1">
    	<tr>

<td>Latitude</td><td>Longitude</td><td>Location</td></tr>

</table>
    
    
    
  </body>
</html>
